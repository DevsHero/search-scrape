# Cross-compilation config for local release builds (cargo-zigbuild from macOS).
#
# The lance/lancedb crate compiles C code that uses AVX512 intrinsics.
# When cross-compiling x86_64-linux from macOS with Zig's lld, those
# symbols are unresolved. Setting CFLAGS to -mno-avx512f disables AVX512
# in the C compiler so the resulting .o files link cleanly.

[target.x86_64-unknown-linux-gnu]
rustflags = ["-C", "target-feature=-avx512f,-avx512bw,-avx512cd,-avx512dq,-avx512vl"]

[target.x86_64-unknown-linux-musl]
rustflags = ["-C", "target-feature=-avx512f,-avx512bw,-avx512cd,-avx512dq,-avx512vl"]
